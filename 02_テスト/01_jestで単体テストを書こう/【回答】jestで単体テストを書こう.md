# jestで単体テストを書こう

## 課題1

ドキュメント読みました。（？）

## 課題2

実装済み。用意されたリポジトリをforkする形だったので、別のリポジトリになってしまいました。

<https://github.com/gn-t-k/praha-challenge-templates/pull/1>

## 課題3

### 課題2の単体テストについて

#### 修正前のfunction.tsは、なぜ単体テストが書けなかったのか

関数内に`datavase.save()`や`nameApiService.getFirstName()`など、出力の結果が保証されない要素があったため。単体テストはロジックが正しく動くかどうかのテストであるため、運要素やそのロジックと本質的に関係のない要素はロジック内に含まれないようにするべきである。

#### 依存性の注入について

運要素やそのロジックと本質的に関係のない要素（**依存性**）をロジック内で用意するのではなく、関数の引数として外部から受け取る（**注入**）ような形にすることを依存性の注入という。

#### モジュールの結合度について

他のモジュールの出力や状態によってそのモジュールの振る舞いが変化してしまう場合、そのモジュールは他のモジュールに依存しているといえる。モジュールの結合度とは、そのモジュールが他のモジュールに依存している度合いのことである。依存しているほど結合度は高くなる。

依存性の注入を実施することで、モジュールの結合度は低くなる。

### テストのたびに外部サービスと通信をする単体テストが（一般的に）よくないとされている理由

単体テストのたびに外部サービスと通信をする場合、下記のような弊害がある。

- テストの実行時間が長くなる
  - 開発効率が落ちる
  - 開発者がテストを実行しなくなってくる
  - テストの失敗が放置されるようになる
- テストの成功/失敗が、外部サービスに依存するようになる
  - 同じ実装でも成功したり失敗したりするようではテストの意味がない
  - 外部サービスの仕様変更があった場合に対応する必要があるなど、保守コストが高くなる
  - 外部サービスとの連携のテストは、統合テストやE2Eテストで実施すべきである

### sumOfArrayの実装の修正について

#### 修正内容

 `reduce`関数の第2引数に初期値`0`を設定。

#### 修正内容の意図

配列内の数値の総和を返すという関数の役割を考えた場合、何も与えなければ0を返すのが自然な挙動であると考えたため。

## 課題4

### ペアに単体テストを書いてもらう

おふたりに3つずつの関数と、それぞれのテストの雛形を用意しましたので、以下のPRのご対応をよろしくお願いします。

- 永井さん：[beerFunctionsのテストを作成](https://github.com/gn-t-k/PrAhaChallengeTasks/pull/11)
- 粟田さん：[coffeeFunctionsのテストを作成](https://github.com/gn-t-k/PrAhaChallengeTasks/pull/12)

Reviewersを自分に設定したかったのですがなぜかできなかったので、ご対応いただけたらslackかPRのコメントでお知らせください。レビューして`learn-unit-test`にマージします。

### クイズ

#### クイズ1

jestのカバレッジレポートについて、以下の項目の意味は何か

- Stmts
- Branch
- Funcs
- Lines

<details>
  <summary>回答</summary>

- Stmts … プログラム内の各命令が実行されている割合
- Branch … プログラム内の各分岐が読み込まれている割合
- Funcs … プログラム内の各関数が実行されている割合
- Lines … プログラム内の各行が読み込まれている割合

</details>

#### クイズ2

axiosのgetメソッドのみモック化したい場合、`xxxxx`に入るjestのメソッド名は何か

```javascript
jest.xxxxx(axios, 'get').mockReturnValue("mockValue")
```

<details>
  <summary>回答</summary>

spyOn

</details>

#### クイズ3

jestを実行すると、テスト結果のレポートが視覚的に見やすいhtml形式で出力される。どこに格納されているか。

<details>
  <summary>回答</summary>

`coverage/lcov-report/index.html`に格納されている。ブラウザがあれば結果が確認できるので、ユニットテストの作成状況の把握・共有に便利。


</details>
