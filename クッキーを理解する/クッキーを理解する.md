# クッキーを理解する

## Cookieとは

Webサーバーからブラウザに送信され、ブラウザに保存されるデータのこと。以降クライアントからサーバーへのリクエストには保存されたCookieが添付される。ユーザーのセッション情報・データの管理に使われることが多い。

### Cookieの作成方法

サーバーからクライアントへのレスポンスにHTTPヘッダ`Set-Cookie: <cookie-name>=<cookie-value>`を設定すると、クライアントのブラウザにCookie（名前と値の組み合わせ）が保存される。以降クライアントからサーバーへのリクエストにはHTTPヘッダ`Cookie: <cookie-name>=<cookie-value>`が設定される。

### Cookieの設定

Cookieは、`Set-Cookie`ヘッダに属性を指定することで有効期限や送信先など様々な設定をすることができる。例えば`Expire`属性で有効期限を設定するときは下記のようになる。

```
Set-Cookie: <cookie-name>=<cookie-value>; Expires=<date>
```

## Cookieの送信先の定義

`Domain`、`Path`、`SameSite`などの属性を設定することで、Cookieの送信先を定義することができる。

### Domain属性

Cookieの送信先の（Cookieを受信することができる）ホストを指定することができる。

```
Set-Cookie: <cookie-name>=<cookie-value>; Domain=<domain-value>
```

Domain属性を指定するとサブドメインを含むホストを指定することができるが、Domain属性を指定しなかった場合（デフォルトの場合）、Cookieを受信できるホストにサブドメインは含まれない。つまり、**Domain属性を設定すると、Domain属性を設定しなかった場合よりも制限が緩和される**ことになるので注意。

### Path属性

`Path`属性でパスを指定すると、URLに指定したパスが含まれていないリクエストは送信されなくなる。

```
Set-Cookie: <cookie-name>=<cookie-value>; Path=<path-value>
```

例えば、`Path=/docs` を設定すると、以下のパスを含むURLのリクエストは送信される。

- `/docs`
- `/docs/Web/`
- `/docs/Web/HTTP`

### SameSite属性

`Strict`、`Lax`、`None`の3段階の値を指定して、オリジン間のCookieの送信可否を制限することができる。

```
Set-Cookie: <cookie-name>=<cookie-value>; SameSite=Strict
Set-Cookie: <cookie-name>=<cookie-value>; SameSite=Lax
Set-Cookie: <cookie-name>=<cookie-value>; SameSite=None
```

#### Strict

#### Lax

#### None

## Cookieへのアクセス制限

### Secure属性

### HttpOnly属性

## Cookieに有効期限を設定する

### Expires属性

### Max-Age属性

### セッションCookieを利用する

## Cookieの扱い方

### 危険性

### Cookie名に接頭辞を設定する

## ブラウザーに情報を格納するCookie以外の方法