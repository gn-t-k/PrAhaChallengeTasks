# DDDを学ぶ（基礎）

## 課題1

### エンティティ

DDDにおける「エンティティ」は、ソフトウェアで解決する課題領域で扱う対象の概念を、値と振る舞いを持つオブジェクトとしてコードに落とし込んだもの。

例えば「ユーザー」をエンティティとして`User`クラスで表現すると、`name`や`age`といった値や`changeName`といった振る舞いを持たせることができる。

`name`や`age`は可変な値であり、`changeName`によって`name`を変更したりできる。値を変更したことによって他のオブジェクトと区別がつかなくなるとオブジェクトを適切に扱えなくなる可能性があるので、エンティティには`id`などの一意な識別子を持たせるか、組み合わせによって必ず一意になるようなプロパティを持たせるなどする。

```typescript
class User {
  private id: string;
  private name: string;
  private age: number;

  constructor(id: string, name: string, age: number) {
    this.id = id;
    this.name = name;
    this.age = age;
  }

  get name(): string {
    return this.name;
  }
  get age(): number {
    return this.age;
  }
  public changeName(name: string) {
    this.name = name;
  }
}
```

### 値オブジェクト

DDDにおける「値オブジェクト」は、ソフトウェアで解決する課題領域で扱う特定の数値や文字列を、計測・定量化・説明するためのオブジェクトとしてコードに落とし込んだもの。

値オブジェクトは値を不変のものとして扱うため、コンストラクタでプロパティを設定して以降はプロパティの値を更新しない。

例えば`User`クラスの`age`プロパティは、プリミティブな値`number`ではなく、値オブジェクトのクラス`Age`として扱うことができる。

```typescript
class Age {
  private age: number

  constructor(age: number) {
    if (age < 0) {
      // 値のバリデーションを設定できる。
      throw new Error('年齢は0歳以上が設定可能です')
    }
    this.age = age;
  }

  get value(): number {
    return this.age;
  }

  public isEqual(age: Age): boolean {
    // 他のAgeオブジェクトと値が等しいかどうかをチェックできる。
    return age.value === this.age;
  }
}

class User {
  private id: string;
  private name: string;
  private age: number;

  constructor(id: string, name: string, age: Age) {
    this.id = id;
    this.name = name;
    this.age = age.value;
  }

  get name(): string {
    return this.name;
  }
  get age(): number {
    return this.age;
  }
  public changeName(name: string): void {
    this.name = name;
  }
}
```

### 集約

DDDにおける「集約」は、オブジェクトのまとまりを表し、整合性を保ちながらデータを更新する単位である。集約に含まれるオブジェクトの生成・読み込み・変更・保存などをとりまとめる役割がある。

集約は集約ルートと呼ばれるオブジェクトを持つ。集約内のオブジェクトに対する操作は、すべて集約ルートをインターフェースとして行われる。これにより、集約内のデータが不正に操作されることを防ぐことができる。

### ユビキタス言語

ドメインエキスパートや開発者などのステークホルダー内で統一した共通言語のこと。ユビキタス言語を用意することによって、ステークホルダー間のコミュニケーションがしやすくなる。

### 境界づけられたコンテキスト

境界づけられたコンテキストとは、ユビキタス言語を適用する範囲のこと。

システムの規模が大きくなってくると、ユビキタス言語としては同じものであってもコンテキスト（文脈）によっては呼び方や扱い方が変わってくるような概念が生まれることがある。全てのシステム内で概念を統一して共通化しようした場合、その概念が巨大になりすぎてしまい、扱いづらくなることがある。DDDでは、大きなシステムを「境界づけられたコンテキスト」に分割し、それぞれのコンテキスト内でモデルやユビキタス言語の統一を目指す。

### ドメイン

DDDにおけるドメインとは、ソフトウェアで解決しようとする課題領域のこと。

DDDでは、エンティティや値オブジェクト、集約と呼ばれる概念を使って、ドメインで扱う概念をオブジェクトの形でコードに落とし込んで表現する。ドメインで扱う概念をオブジェクトで表現したものをドメインモデルと呼ぶ。

### ドメインサービス

ドメインサービスとは、ドメインモデルだけではドメインで扱う概念を適切に表現できない場合に定義される振る舞いのこと。

DDDでは、ドメインで扱う概念は極力ドメインモデルで表現し、どうしてもそれが難しい場合のみドメインサービスで表現する。ドメインモデルで表現するべき情報をドメインサービスで表現してしまうと、同一の処理があらゆる場所に書かれてしまったり、コードのドキュメント性が低下するなどの弊害が起きることがある。

### リポジトリ

### アプリケーション

### CQRS

### DTO

## 課題2

### クイズ1

### クイズ2

### クイズ3
